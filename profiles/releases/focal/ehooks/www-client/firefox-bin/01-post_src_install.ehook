ebuild_hook() {
	local desktopfile="${ED}/usr/share/applications/${PN}.desktop"

	newmenu "${EHOOK_FILESDIR}/${PN%-bin}.desktop.in" "${PN}.desktop"

	sed -i \
		-e "\:Exec:{s:@MOZ_APP_NAME@:/usr/bin/${PN}:g}" \
		"${desktopfile}" || die

	sed -i \
		-e "/%%ifdef/d" \
		-e "/%%else/,+$(( $(grep -n %%endif < ${desktopfile} | cut -d ':' -f 1) - $(grep -n %%else < ${desktopfile} | cut -d ':' -f 1) )) d" \
		-e "s/@MOZ_APP_NAME@/${PN}/" \
		"${desktopfile}" || die
}
